<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Async & Fetch Exercises #3</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    img { margin: 10px; max-height: 200px; }
    #gifContainer { display: flex; flex-wrap: wrap; }
    button, input { margin: 5px; padding: 8px 12px; }
  </style>
</head>
<body>
  <h1>Exercises - Fetch API & Async/Await</h1>

  <!-- ========== Exercise 1 ========== -->
  <h2>Exercise 1: Giphy API (Category Search)</h2>
  <form id="gifForm">
    <input type="text" id="category" placeholder="Enter category (e.g. cats)">
    <button type="submit">Get GIFs</button>
  </form>
  <button id="deleteBtn">Delete All GIFs</button>
  <div id="gifContainer"></div>
  <hr>

  <!-- ========== Exercise 2 ========== -->
  <h2>Exercise 2: Analyze #4 (Concurrent Promise.all)</h2>
  <button onclick="setTimeout(concurrentPromise, 1000)">Run Concurrent Promise.all</button>
  <hr>

  <!-- ========== Exercise 3 ========== -->
  <h2>Exercise 3: Analyze #5 (Parallel Async + Promise.all)</h2>
  <button onclick="setTimeout(parallel, 1000)">Run Parallel Await</button>
  <hr>

  <!-- ========== Exercise 4 ========== -->
  <h2>Exercise 4: Analyze #6 (Parallel Promise.then)</h2>
  <button onclick="setTimeout(parallelPromise, 1000)">Run Parallel .then()</button>
  <hr>


  <script>
    /* ------------------- Exercise 1 ------------------- */
    const API_KEY = "hpvZycW22qCjn5cRM1xtWB8NKq4dQ2My"; // provided
    const form = document.getElementById("gifForm");
    const input = document.getElementById("category");
    const gifContainer = document.getElementById("gifContainer");
    const deleteBtn = document.getElementById("deleteBtn");

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      const category = input.value.trim();
      if (!category) return;

      try {
        const response = await fetch(
          `https://api.giphy.com/v1/gifs/search?api_key=${API_KEY}&q=${category}&limit=5`
        );
        if (!response.ok) throw new Error("Network response failed");

        const data = await response.json();
        data.data.forEach(gif => {
          const img = document.createElement("img");
          img.src = gif.images.fixed_height.url;
          gifContainer.appendChild(img);
        });
      } catch (err) {
        console.error("Error fetching GIFs:", err);
      }
    });

    deleteBtn.addEventListener("click", () => {
      gifContainer.innerHTML = "";
    });

    /* ------------------- Shared Promises ------------------- */
    let resolveAfter2Seconds = function () {
      console.log("starting slow promise");
      return new Promise(resolve => {
        setTimeout(function () {
          resolve("slow");
          console.log("slow promise is done");
        }, 2000);
      });
    };

    let resolveAfter1Second = function () {
      console.log("starting fast promise");
      return new Promise(resolve => {
        setTimeout(function () {
          resolve("fast");
          console.log("fast promise is done");
        }, 1000);
      });
    };

    /* ------------------- Exercise 2 ------------------- */
    let concurrentPromise = function () {
      console.log('==CONCURRENT START with Promise.all==');
      return Promise.all([resolveAfter2Seconds(), resolveAfter1Second()])
        .then((messages) => {
          console.log(messages[0]); // "slow"
          console.log(messages[1]); // "fast"
        });
    };

    /* ------------------- Exercise 3 ------------------- */
    let parallel = async function () {
      console.log('==PARALLEL with await Promise.all==');
      await Promise.all([
        (async () => console.log(await resolveAfter2Seconds()))(),
        (async () => console.log(await resolveAfter1Second()))()
      ]);
    };

    /* ------------------- Exercise 4 ------------------- */
    let parallelPromise = function () {
      console.log('==PARALLEL with Promise.then==');
      resolveAfter2Seconds().then((message) => console.log(message));
      resolveAfter1Second().then((message) => console.log(message));
    };
  </script>
</body>
</html>
